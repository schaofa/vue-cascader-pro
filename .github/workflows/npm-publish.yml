# This workflow will run tests using node and then publish a package to GitHub Packages when a release is created
# For more information see: https://docs.github.com/en/actions/publishing-packages/publishing-nodejs-packages

name: Publish package to Node.js

on:
  push:
    tags:
      - '**'
    #分支可以选择多个，如main、dev
    #监听main分支的push操作，只要main分支发生push操作，就会运行发布代码

jobs:
    publish:
      runs-on: ubuntu-latest

      steps:
        - name: Checkout source code
          uses: actions/checkout@v2
  
        - name: Set up Node.js
          uses: actions/setup-node@v2
          with:
            node-version: 16
  
        - name: Install dependencies
          run: npm install
  
        - name: Build package
          run: npm run build
  
        - name: Publish to npm
          run: npm publish
          env:
            NODE_AUTH_TOKEN: ${{ secrets.NPM_SECRET_KEY }}
